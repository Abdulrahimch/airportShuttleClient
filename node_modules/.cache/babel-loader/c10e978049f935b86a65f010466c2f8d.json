{"ast":null,"code":"import _slicedToArray from\"/home/cisco/airportShuttleDeploy/airportShuttleV2/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from'react';import useStyles from'./useStyles';import{format}from'date-fns';import{Box,Tab}from'@material-ui/core';import DataTable from'../../components/DataTable/DataTable';import{engColumn,turksihColumns}from'../../utils/dictionary';import{getReservations}from'../../helpers/APICalls/reservation';import{deleteReservation}from'../../helpers/APICalls/reservation';import{useSnackBar}from'../../context/useSnackbarContext';import CustomDialog from'../../components/CustomDialog/CustomDialog';import{useHistory}from'react-router-dom';import{useLanguage}from'../../context/useLanguageContext';import TabContext from'@material-ui/lab/TabContext';import TabList from'@material-ui/lab/TabList';import TabPanel from'@material-ui/lab/TabPanel';import{turkishTabs,engTabs}from'../../utils/dictionary';import DriverDetail from'../Agency/Drivers/DriverDetail/DriverDetail';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var driverInitValue={name:'',img:'',carNumber:'',phoneNumber:0,email:''};function ListReservations(){var _useStyles=useStyles(),root=_useStyles.root;var history=useHistory();var _useLanguage=useLanguage(),language=_useLanguage.language;var _useSnackBar=useSnackBar(),updateSnackBarMessage=_useSnackBar.updateSnackBarMessage;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),confirmedReservations=_useState2[0],setConfirmedReservations=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),unConfirmedReservations=_useState4[0],setUnConfirmedReservations=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),open=_useState6[0],setOpen=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),openDetailDialog=_useState8[0],setOpenDetailDialog=_useState8[1];var _useState9=useState(driverInitValue),_useState10=_slicedToArray(_useState9,2),driver=_useState10[0],setDriver=_useState10[1];var _useState11=useState('1'),_useState12=_slicedToArray(_useState11,2),value=_useState12[0],setValue=_useState12[1];var _useState13=useState({type:0,from:0,to:0,property:'',pax:5,flightNo:'',driverNote:'',selectedDate:new Date(),timezone:0,passengers:[]}),_useState14=_slicedToArray(_useState13,2),initValues=_useState14[0],setInitValues=_useState14[1];var handleDialogClose=function handleDialogClose(){setOpen(false);};var handleCacelClick=function handleCacelClick(cellValues){var id=cellValues.row._id;deleteReservation(id).then(function(data){if(data.error){updateSnackBarMessage(data.error.message);}else if(data.success){updateSnackBarMessage('reservation deleted!');setConfirmedReservations(confirmedReservations.filter(function(row){return row.id!==cellValues.id;}));}else{updateSnackBarMessage('An unexpected error occurred. Please try again !');}});};var handleEditClick=function handleEditClick(cellValues){setInitValues(cellValues.row);setOpen(true);};var handleChange=function handleChange(event,newValue){setValue(newValue);};var handleDriverDetails=function handleDriverDetails(cellValues){setDriver(cellValues.row.driver);setOpenDetailDialog(true);};var onDetailDialogClose=function onDetailDialogClose(){setOpenDetailDialog(false);};var columns=language==='tr'?turksihColumns(handleEditClick,handleCacelClick,handleDriverDetails):engColumn(handleEditClick,handleCacelClick,handleDriverDetails);var tabs=language==='tr'?turkishTabs:engTabs;useEffect(function(){getReservations().then(function(data){if(data.error){console.log(data.error);}else if(data.success){data.success.reservations.confirmedReservations.map(function(reservation,idx){reservation.id=idx+1;reservation.status='reservation';var date=new Date(reservation.selectedDate);reservation.date=format(date,\"dd-MM-yyyy kk:mm\");});setConfirmedReservations(data.success.reservations.confirmedReservations);data.success.reservations.unConfirmedReservations.map(function(reservation,idx){reservation.id=idx+1;var date=new Date(reservation.selectedDate);reservation.date=format(date,\"dd-MM-yyyy kk:mm\");});setUnConfirmedReservations(data.success.reservations.unConfirmedReservations);}else{console.log('External error');}});return function(){setConfirmedReservations([]);setUnConfirmedReservations([]);};},[history,open]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Box,{sx:{width:'100%'},className:root,children:[/*#__PURE__*/_jsxs(TabContext,{value:value,children:[/*#__PURE__*/_jsx(Box,{sx:{borderBottom:1,borderColor:'divider'},children:/*#__PURE__*/_jsx(TabList,{onChange:handleChange,\"aria-label\":\"lab API tabs example\",children:tabs.map(function(_ref,idx){var label=_ref.label,value=_ref.value;return/*#__PURE__*/_jsx(Tab,{label:label,value:value},idx);})})}),/*#__PURE__*/_jsx(TabPanel,{value:\"1\",style:{width:'100%'},children:/*#__PURE__*/_jsx(DataTable,{rows:confirmedReservations,columns:columns})}),/*#__PURE__*/_jsx(TabPanel,{value:\"2\",style:{width:'100%'},children:/*#__PURE__*/_jsx(DataTable,{rows:unConfirmedReservations,columns:columns})})]}),/*#__PURE__*/_jsx(CustomDialog,{open:openDetailDialog,onClose:onDetailDialogClose,style:\"updateReservation\",children:/*#__PURE__*/_jsx(DriverDetail,{driver:driver})})]})});}export default ListReservations;","map":{"version":3,"sources":["/home/cisco/airportShuttleDeploy/airportShuttleV2/client/src/pages/ClientReservations/ListReservations.tsx"],"names":["useEffect","useState","useStyles","format","Box","Tab","DataTable","engColumn","turksihColumns","getReservations","deleteReservation","useSnackBar","CustomDialog","useHistory","useLanguage","TabContext","TabList","TabPanel","turkishTabs","engTabs","DriverDetail","driverInitValue","name","img","carNumber","phoneNumber","email","ListReservations","root","history","language","updateSnackBarMessage","confirmedReservations","setConfirmedReservations","unConfirmedReservations","setUnConfirmedReservations","open","setOpen","openDetailDialog","setOpenDetailDialog","driver","setDriver","value","setValue","type","from","to","property","pax","flightNo","driverNote","selectedDate","Date","timezone","passengers","initValues","setInitValues","handleDialogClose","handleCacelClick","cellValues","id","row","_id","then","data","error","message","success","filter","handleEditClick","handleChange","event","newValue","handleDriverDetails","onDetailDialogClose","columns","tabs","console","log","reservations","map","reservation","idx","status","date","width","borderBottom","borderColor","label"],"mappings":"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","sourcesContent":["import { useEffect, useState } from 'react';\nimport useStyles from './useStyles';\nimport { format } from 'date-fns';\nimport { Box, Tab } from '@material-ui/core';\nimport DataTable from '../../components/DataTable/DataTable';\nimport { engColumn, turksihColumns } from '../../utils/dictionary';\nimport { getReservations } from '../../helpers/APICalls/reservation';\nimport { deleteReservation } from '../../helpers/APICalls/reservation';\nimport { useSnackBar } from '../../context/useSnackbarContext';\nimport CustomDialog from '../../components/CustomDialog/CustomDialog';\nimport { useHistory } from 'react-router-dom';\nimport { useLanguage } from '../../context/useLanguageContext';\nimport TabContext from '@material-ui/lab/TabContext';\nimport TabList from '@material-ui/lab/TabList';\nimport TabPanel from '@material-ui/lab/TabPanel';\nimport { turkishTabs, engTabs } from '../../utils/dictionary';\nimport DriverDetail from '../Agency/Drivers/DriverDetail/DriverDetail';\nimport { Driver } from '../../interface/Driver';\n\nconst driverInitValue = {\n    name: '',\n    img: '',\n    carNumber: '',\n    phoneNumber: 0,\n    email: ''\n};\n\nfunction ListReservations(): JSX.Element{\n    const { root } = useStyles();\n    const history = useHistory();\n    const { language } = useLanguage();\n    const { updateSnackBarMessage } = useSnackBar();\n\n    const [confirmedReservations, setConfirmedReservations] = useState<any>([]);\n    const [unConfirmedReservations, setUnConfirmedReservations] = useState<any>([]);\n    const [open, setOpen] = useState<boolean>(false);\n    const [openDetailDialog, setOpenDetailDialog] = useState<boolean>(false);\n    const [driver, setDriver] = useState<Driver>(driverInitValue);\n    const [value, setValue] = useState('1');\n    const [initValues, setInitValues] = useState( {\n        type: 0,\n        from: 0,\n        to: 0,\n        property: '',\n        pax: 5,\n        flightNo: '',\n        driverNote: '',\n        selectedDate: new Date(),\n        timezone: 0,\n        passengers: []\n        });\n\n    const handleDialogClose = () => {\n        setOpen(false)\n    };\n\n    const handleCacelClick = (cellValues: any) => {\n        const id = cellValues.row._id;\n        deleteReservation(id).then((data) => {\n            if (data.error) {\n                updateSnackBarMessage(data.error.message);\n            } else if (data.success) {\n                updateSnackBarMessage('reservation deleted!');\n                setConfirmedReservations(confirmedReservations.filter((row: any) => row.id !== cellValues.id));\n            } else {\n                updateSnackBarMessage('An unexpected error occurred. Please try again !');\n            }\n        })\n        \n    };\n    const handleEditClick = (cellValues: any) => {\n        setInitValues(cellValues.row)\n        setOpen(true)\n    };\n\n    const handleChange = (event:  any, newValue: string) => {\n        setValue(newValue);\n    };\n\n    const handleDriverDetails = (cellValues: any) => {\n        setDriver(cellValues.row.driver);\n        setOpenDetailDialog(true);\n    };\n\n    const onDetailDialogClose = () => {\n        setOpenDetailDialog(false);\n    };\n\n    const columns = language === 'tr' ? turksihColumns(handleEditClick, handleCacelClick, handleDriverDetails)\n                                      : engColumn(handleEditClick, handleCacelClick, handleDriverDetails);\n    const tabs = language === 'tr' ? turkishTabs : engTabs\n\n    useEffect(() => {\n        getReservations().then((data) => {\n            if (data.error){\n                console.log(data.error)\n            } else if (data.success) {\n                data.success.reservations.confirmedReservations.map((reservation, idx) => {\n                    reservation.id = idx + 1;\n                    reservation.status = 'reservation';\n                    const date = new Date(reservation.selectedDate)\n                    reservation.date = format(date, \"dd-MM-yyyy kk:mm\")\n                });\n                setConfirmedReservations(data.success.reservations.confirmedReservations);\n                data.success.reservations.unConfirmedReservations.map((reservation, idx) => {\n                    reservation.id = idx + 1;\n                    const date = new Date(reservation.selectedDate)\n                    reservation.date = format(date, \"dd-MM-yyyy kk:mm\")\n                });\n                setUnConfirmedReservations(data.success.reservations.unConfirmedReservations);\n            } else {\n                console.log('External error')\n            }\n        })\n        return () => {\n            setConfirmedReservations([]);\n            setUnConfirmedReservations([]);\n        }\n    }, [history, open]);\n\n    \n    \n    return (\n        <>\n            <Box sx={{ width: '100%' }} className={root}>\n                <TabContext value={value}>\n                    <Box sx={{ borderBottom: 1, borderColor: 'divider' }}>\n                        <TabList onChange={handleChange} aria-label=\"lab API tabs example\">\n                            {tabs.map(({label, value}, idx) => (\n                                <Tab key={idx} label={label} value={value} />\n                            ))}\n                        </TabList>\n                    </Box>\n                    <TabPanel value=\"1\" style={{ width: '100%' }}><DataTable rows={confirmedReservations} columns={columns} /></TabPanel>\n                    <TabPanel value=\"2\" style={{ width: '100%' }}><DataTable rows={unConfirmedReservations} columns={columns} /></TabPanel>\n                </TabContext>\n                <CustomDialog open={openDetailDialog} onClose={onDetailDialogClose} style='updateReservation'>\n                    <DriverDetail driver={driver}/>\n                </CustomDialog>\n            </Box>\n        </>\n    )\n}\n\nexport default ListReservations;"]},"metadata":{},"sourceType":"module"}