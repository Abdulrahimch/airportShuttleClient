{"ast":null,"code":"import _slicedToArray from\"/home/cisco/airportShuttleDeploy/airportShuttleV2/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from\"react\";import{format}from'date-fns';import DataTable from'../../../components/DataTable/DataTable';import{Box}from\"@material-ui/core\";import{agencyTurksihColumns,agencyEngColumns}from'../../../utils/dictionary/listAgencyReservation';import{getReservations,updateReservation}from'../../../helpers/APICalls/agencyReservation';import{useLanguage}from'../../../context/useLanguageContext';import{useSnackBar}from'../../../context/useSnackbarContext';import CustomDialog from\"../../../components/CustomDialog/CustomDialog\";import AssignDriver from\"../Drivers/AssignDriver/AssignDriver\";import Search from\"../../../components/Search/Search\";import ListPassengers from\"./ListPassengers\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ListAgencyReservations(){var _useLanguage=useLanguage(),language=_useLanguage.language;var _useSnackBar=useSnackBar(),updateSnackBarMessage=_useSnackBar.updateSnackBarMessage;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),rows=_useState2[0],setRows=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),open=_useState4[0],setOpen=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),openShowDialog=_useState6[0],setOpenShowDialog=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),useEffectTrigger=_useState8[0],setUseEffectTrigger=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),reservation=_useState10[0],setReservation=_useState10[1];var _useState11=useState(new Date()),_useState12=_slicedToArray(_useState11,2),from=_useState12[0],setFrom=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),passengers=_useState14[0],setPassengers=_useState14[1];var date=new Date();var _useState15=useState(new Date(date.setHours(date.getHours()+24))),_useState16=_slicedToArray(_useState15,2),to=_useState16[0],setTo=_useState16[1];var handleProcessedClick=function handleProcessedClick(cellValues){var id=cellValues.row._id;var inputs={status:'processed'};updateReservation(inputs,id).then(function(data){if(data.error){updateSnackBarMessage(data.error);}else if(data.success){updateSnackBarMessage('reservation has been processed successfully!');setRows(rows.filter(function(row){return row.id!==cellValues.id;}));}else{updateSnackBarMessage('An unexpected error occurred. Please try again !');}});};var handleUnprocessedClick=function handleUnprocessedClick(cellValues){var id=cellValues.row._id;var inputs={status:'unprocessed'};updateReservation(inputs,id).then(function(data){if(data.error){updateSnackBarMessage(data.error);}else if(data.success){updateSnackBarMessage('reservation has been unprocessed successfully!');setRows(rows.filter(function(row){return row.id!==cellValues.id;}));}else{updateSnackBarMessage('An unexpected error occurred. Please try again !');}});};var handleConfirmClick=function handleConfirmClick(cellValues){setReservation(cellValues.row);setOpen(true);};var handleClose=function handleClose(){setOpen(false);};var invokeUseEffect=function invokeUseEffect(){setUseEffectTrigger(!useEffectTrigger);};var handleShowClick=function handleShowClick(cellValues){setPassengers(cellValues.row.passengers);setOpenShowDialog(true);};var handleShowDialogClose=function handleShowDialogClose(){setOpenShowDialog(false);};useEffect(function(){getReservations(from,to).then(function(data){if(data.error){updateSnackBarMessage(data.error);}else if(data.success){console.log(data.success);data.success.reservations.map(function(reservation,idx){var _reservation$client;reservation.id=idx+1;reservation.status='reservation';var date=new Date(reservation.selectedDate);reservation.date=format(date,\"dd-MM-yyyy kk:mm\");reservation.property=(_reservation$client=reservation.client)===null||_reservation$client===void 0?void 0:_reservation$client.propertyName;});setRows(data.success.reservations);}else{updateSnackBarMessage('An unexpected error occurred. Please try again !');}});return function(){setRows([]);};},[useEffectTrigger]);var columns=language==='eng'?agencyEngColumns(handleProcessedClick,handleUnprocessedClick,handleConfirmClick,handleShowClick):agencyTurksihColumns(handleProcessedClick,handleUnprocessedClick,handleConfirmClick,handleShowClick);return/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Search,{from:from,to:to,setFrom:setFrom,setTo:setTo,invokeUseEffect:invokeUseEffect}),/*#__PURE__*/_jsx(DataTable,{rows:rows,columns:columns}),/*#__PURE__*/_jsx(CustomDialog,{open:open,onClose:handleClose,children:/*#__PURE__*/_jsx(AssignDriver,{reservation:reservation,invokeUseEffect:invokeUseEffect,handleClose:handleClose})}),/*#__PURE__*/_jsx(CustomDialog,{open:openShowDialog,onClose:handleShowDialogClose,children:/*#__PURE__*/_jsx(ListPassengers,{passengers:passengers})})]});};export default ListAgencyReservations;","map":{"version":3,"sources":["/home/cisco/airportShuttleDeploy/airportShuttleV2/client/src/pages/Agency/Reservation/ListAgencyReservations.tsx"],"names":["useEffect","useState","format","DataTable","Box","agencyTurksihColumns","agencyEngColumns","getReservations","updateReservation","useLanguage","useSnackBar","CustomDialog","AssignDriver","Search","ListPassengers","ListAgencyReservations","language","updateSnackBarMessage","rows","setRows","open","setOpen","openShowDialog","setOpenShowDialog","useEffectTrigger","setUseEffectTrigger","reservation","setReservation","Date","from","setFrom","passengers","setPassengers","date","setHours","getHours","to","setTo","handleProcessedClick","cellValues","id","row","_id","inputs","status","then","data","error","success","filter","handleUnprocessedClick","handleConfirmClick","handleClose","invokeUseEffect","handleShowClick","handleShowDialogClose","console","log","reservations","map","idx","selectedDate","property","client","propertyName","columns"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport { format } from 'date-fns';\nimport DataTable from '../../../components/DataTable/DataTable';\nimport { Box } from \"@material-ui/core\";\nimport { agencyTurksihColumns, agencyEngColumns } from '../../../utils/dictionary/listAgencyReservation';\nimport { getReservations, updateReservation } from '../../../helpers/APICalls/agencyReservation';\nimport { useLanguage } from '../../../context/useLanguageContext';\nimport { useSnackBar } from '../../../context/useSnackbarContext';\nimport CustomDialog from \"../../../components/CustomDialog/CustomDialog\";\nimport AssignDriver from \"../Drivers/AssignDriver/AssignDriver\";\nimport { Reservation } from '../../../interface/agencyReservation';\nimport Search from \"../../../components/Search/Search\";\nimport ListPassengers from \"./ListPassengers\";\n\nfunction ListAgencyReservations(): JSX.Element {\n    const { language } = useLanguage();\n    const { updateSnackBarMessage } = useSnackBar();\n    const [rows, setRows] = useState<any>([]);\n    const [open, setOpen] = useState<boolean>(false)\n    const [openShowDialog, setOpenShowDialog] = useState<boolean>(false)\n    const [useEffectTrigger, setUseEffectTrigger] = useState<boolean>(false);\n    const [reservation, setReservation] = useState<Reservation>()\n    const [from, setFrom] = useState(new Date());\n    const [passengers, setPassengers] = useState<string[]>([]);\n    const date = new Date();\n    const [to, setTo] = useState(new Date(date.setHours(date.getHours() + 24)));\n\n    const handleProcessedClick = (cellValues: any) => {\n        const id = cellValues.row._id;\n        const inputs = { status: 'processed' };\n        updateReservation(inputs, id).then((data) => {\n            if (data.error) {\n                updateSnackBarMessage(data.error);\n            } else if (data.success) {\n                updateSnackBarMessage('reservation has been processed successfully!');\n                setRows(rows.filter((row: any) => row.id !== cellValues.id));\n            } else {\n                updateSnackBarMessage('An unexpected error occurred. Please try again !');\n            }\n        })\n    }\n\n    const handleUnprocessedClick = (cellValues: any) => {\n        const id = cellValues.row._id;\n        const inputs = { status: 'unprocessed' };\n        updateReservation(inputs, id).then((data) => {\n            if (data.error) {\n                updateSnackBarMessage(data.error);\n            } else if (data.success) {\n                updateSnackBarMessage('reservation has been unprocessed successfully!');\n                setRows(rows.filter((row: any) => row.id !== cellValues.id));\n            } else {\n                updateSnackBarMessage('An unexpected error occurred. Please try again !');\n            }\n        });\n    };\n\n    const handleConfirmClick = (cellValues: any) => {\n        setReservation(cellValues.row);\n        setOpen(true);\n    };\n\n    const handleClose = () => {\n        setOpen(false);\n    };\n\n    const invokeUseEffect = () => {\n        setUseEffectTrigger(!useEffectTrigger)\n    };\n\n    const handleShowClick = (cellValues: any) => {\n        setPassengers(cellValues.row.passengers);\n        setOpenShowDialog(true);\n    };\n\n    const handleShowDialogClose = () => {\n        setOpenShowDialog(false);\n    };\n\n    useEffect(() => {\n        getReservations(from, to).then((data) => {\n            if (data.error){\n                updateSnackBarMessage(data.error);\n            } else if (data.success) {\n                console.log(data.success)\n                data.success.reservations.map((reservation, idx) => {\n                    reservation.id = idx + 1;\n                    reservation.status = 'reservation';\n                    const date = new Date(reservation.selectedDate)\n                    reservation.date = format(date, \"dd-MM-yyyy kk:mm\");\n                    reservation.property = reservation.client?.propertyName;\n                });\n                setRows(data.success.reservations);\n            } else {\n                updateSnackBarMessage('An unexpected error occurred. Please try again !');\n            }\n\n        });\n        return () => {\n            setRows([]);\n        }\n    }, [useEffectTrigger]);\n\n    const columns = language === 'eng' ? agencyEngColumns(handleProcessedClick, handleUnprocessedClick, handleConfirmClick, handleShowClick) \n                                       : agencyTurksihColumns(handleProcessedClick, handleUnprocessedClick, handleConfirmClick, handleShowClick);\n\n    return (\n        <Box>\n            <Search from={from} to={to} setFrom={setFrom} setTo={setTo} invokeUseEffect={invokeUseEffect}/>\n            <DataTable rows={rows} columns={columns} />\n            <CustomDialog open={open} onClose={handleClose}>\n                <AssignDriver reservation={reservation} invokeUseEffect={invokeUseEffect} handleClose={handleClose} />\n            </CustomDialog>\n            <CustomDialog open={openShowDialog} onClose={handleShowDialogClose}>\n                <ListPassengers passengers={passengers} />\n            </CustomDialog>\n        </Box>\n    )\n};\n\nexport default ListAgencyReservations;"]},"metadata":{},"sourceType":"module"}