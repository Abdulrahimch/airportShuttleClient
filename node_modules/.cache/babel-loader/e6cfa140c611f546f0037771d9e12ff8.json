{"ast":null,"code":"import _objectSpread from\"/home/cisco/airportShuttleDeploy/airportShuttleV2/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/cisco/airportShuttleDeploy/airportShuttleV2/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from'react';import DataTable from\"../../../components/DataTable/DataTable\";import{turkishClientColumn,engClientColumn}from'../../../utils/dictionary';import{useLanguage}from'../../../context/useLanguageContext';import{useSnackBar}from'../../../context/useSnackbarContext';import{deleteClient,getClients}from'../../../helpers/APICalls/user';import{format}from'date-fns';import{useHistory}from'react-router-dom';import CustomDialog from'../../../components/CustomDialog/CustomDialog';import{Box,Typography}from'@material-ui/core';import CustomButton from'../../../components/Button/CustomButton';import useStyles from'./useStyles';import UpdateClient from'../UpdateClient/UpdateClient';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var initialValues={email:'',firstName:'',lastName:'',businessType:'',address:'',propertyName:'',IstAirportMaxFourPaxCost:0,IstAirportMaxSixPaxCost:0,IstAirportMaxTenPaxCost:0,SawAirportMaxFourPaxCost:0,SawAirportMaxSixPaxCost:0,SawAirportMaxTenPaxCost:0};var ListClients=function ListClients(){var _useStyles=useStyles(),mainBox=_useStyles.mainBox,title=_useStyles.title;var _useLanguage=useLanguage(),language=_useLanguage.language;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),rows=_useState2[0],setRows=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),openDialog=_useState4[0],setOpenDialog=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),openUpdateClient=_useState6[0],setOpenUpdateClient=_useState6[1];var _useState7=useState(initialValues),_useState8=_slicedToArray(_useState7,2),cellValue=_useState8[0],setCellValue=_useState8[1];var _useSnackBar=useSnackBar(),updateSnackBarMessage=_useSnackBar.updateSnackBarMessage;var history=useHistory();useEffect(function(){getClients().then(function(data){if(data.error){console.log(data.error);updateSnackBarMessage(data.error.message);}else if(data.success){data.success.clients.map(function(client,idx){client.id=idx+1;var date=new Date(client.createdAt?client.createdAt:Date.now());client.createdAt=format(date,'dd-MM-yyyy kk:mm');});setRows(data.success.clients);}else{updateSnackBarMessage('An unexpected error occurred. Please try again !');}});},[history]);var handleEditClick=function handleEditClick(values){setOpenUpdateClient(true);setCellValue(values.row);};var handleCancelClick=function handleCancelClick(values){setOpenDialog(true);setCellValue(values.row);};var handleUpdateClientClose=function handleUpdateClientClose(){setOpenUpdateClient(false);};var onYesClick=function onYesClick(){var id=cellValue===null||cellValue===void 0?void 0:cellValue._id;deleteClient(id).then(function(data){if(data.error){updateSnackBarMessage(data.error.message);}else if(data.success){updateSnackBarMessage('Client has been deleted successfully!');setRows(rows.filter(function(row){return row.id!==(cellValue===null||cellValue===void 0?void 0:cellValue.id);}));setOpenDialog(false);}else{updateSnackBarMessage('An unexpected error occurred. Please try again !');}});};var handleCloseDialog=function handleCloseDialog(){setOpenDialog(false);};var handleUpdatedClientSuccess=function handleUpdatedClientSuccess(rowValue,client){setRows(rows.map(function(row){return row._id===rowValue._id?_objectSpread(_objectSpread({},row),client):row;}));setOpenUpdateClient(false);};var dialog=language==='tr'?{text:'Bu müşteriyi silmek istediğinizden emin misiniz?',yes:'Evet',no:'Hayır '}:{text:'Are you sure you want to delete this client?',yes:'Yes',no:'No '};var columns=language==='tr'?turkishClientColumn(handleEditClick,handleCancelClick):engClientColumn(handleEditClick,handleCancelClick);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(DataTable,{rows:rows,columns:columns}),/*#__PURE__*/_jsx(CustomDialog,{open:openDialog,onClose:handleCloseDialog,children:/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Box,{display:\"flex\",alignItems:\"center\",flexDirection:\"column\",className:mainBox,children:[/*#__PURE__*/_jsx(Typography,{className:title,children:dialog.text}),/*#__PURE__*/_jsxs(Box,{justifyContent:\"center\",m:2,pt:3,children:[/*#__PURE__*/_jsx(CustomButton,{btnText:dialog.yes,style:\"yes\",onClick:onYesClick}),/*#__PURE__*/_jsx(CustomButton,{btnText:dialog.no,style:\"no\",onClick:handleCloseDialog})]})]})})}),/*#__PURE__*/_jsx(CustomDialog,{open:openUpdateClient,onClose:handleUpdateClientClose,children:/*#__PURE__*/_jsx(UpdateClient,{values:cellValue,handleUpdatedClientSuccess:handleUpdatedClientSuccess})})]});};export default ListClients;","map":{"version":3,"sources":["/home/cisco/airportShuttleDeploy/airportShuttleV2/client/src/pages/Agency/ListClients/ListClients.tsx"],"names":["useState","useEffect","DataTable","turkishClientColumn","engClientColumn","useLanguage","useSnackBar","deleteClient","getClients","format","useHistory","CustomDialog","Box","Typography","CustomButton","useStyles","UpdateClient","initialValues","email","firstName","lastName","businessType","address","propertyName","IstAirportMaxFourPaxCost","IstAirportMaxSixPaxCost","IstAirportMaxTenPaxCost","SawAirportMaxFourPaxCost","SawAirportMaxSixPaxCost","SawAirportMaxTenPaxCost","ListClients","mainBox","title","language","rows","setRows","openDialog","setOpenDialog","openUpdateClient","setOpenUpdateClient","cellValue","setCellValue","updateSnackBarMessage","history","then","data","error","console","log","message","success","clients","map","client","idx","id","date","Date","createdAt","now","handleEditClick","values","row","handleCancelClick","handleUpdateClientClose","onYesClick","_id","filter","handleCloseDialog","handleUpdatedClientSuccess","rowValue","dialog","text","yes","no","columns"],"mappings":"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","sourcesContent":["import { useState, useEffect } from 'react';\nimport DataTable from \"../../../components/DataTable/DataTable\";\nimport { turkishClientColumn, engClientColumn } from '../../../utils/dictionary';\nimport { useLanguage } from '../../../context/useLanguageContext';\nimport { useSnackBar } from '../../../context/useSnackbarContext';\nimport { deleteClient, getClients } from '../../../helpers/APICalls/user';\nimport { format } from 'date-fns';\nimport { Client } from '../../../interface/Client';\nimport { useHistory } from 'react-router-dom';\nimport CustomDialog from '../../../components/CustomDialog/CustomDialog';\nimport { Box, Typography } from '@material-ui/core';\nimport CustomButton from '../../../components/Button/CustomButton';\nimport useStyles from './useStyles';\nimport UpdateClient from '../UpdateClient/UpdateClient';\n\nconst initialValues={\n    email: '',\n    firstName: '',\n    lastName: '',\n    businessType: '',\n    address: '',\n    propertyName: '',\n    IstAirportMaxFourPaxCost: 0,\n    IstAirportMaxSixPaxCost: 0,\n    IstAirportMaxTenPaxCost: 0,\n    SawAirportMaxFourPaxCost: 0,\n    SawAirportMaxSixPaxCost: 0,\n    SawAirportMaxTenPaxCost: 0,\n};\n\nconst ListClients = (): JSX.Element => {\n    const { mainBox, title } = useStyles();\n    const { language } = useLanguage();\n    const [rows, setRows] = useState<Client []>([]);\n    const [openDialog, setOpenDialog] = useState<boolean>(false);\n    const [openUpdateClient, setOpenUpdateClient] = useState<boolean>(false);\n    const [cellValue, setCellValue] = useState<Client>(initialValues);\n\n    const { updateSnackBarMessage } = useSnackBar();\n    const history = useHistory();\n\n    useEffect(() => {\n        getClients().then((data) => {\n            if (data.error) {\n                console.log(data.error);\n                updateSnackBarMessage(data.error.message);\n            } else if (data.success){\n                data.success.clients.map((client, idx) => {\n                    client.id = idx + 1;\n                    const date = new Date(client.createdAt ? client.createdAt : Date.now());\n                    client.createdAt = format(date, 'dd-MM-yyyy kk:mm')\n                });\n                setRows(data.success.clients);\n            } else {\n                updateSnackBarMessage('An unexpected error occurred. Please try again !');\n            }\n        });\n    }, [history]);\n\n    const handleEditClick = (values: any) => {\n        setOpenUpdateClient(true);\n        setCellValue(values.row);\n    };\n\n    const handleCancelClick = (values: any) => {\n        setOpenDialog(true);\n        setCellValue(values.row);\n    };\n\n    const handleUpdateClientClose = () => {\n        setOpenUpdateClient(false);\n    };\n\n    const onYesClick = () => {\n        const id = cellValue?._id;\n        deleteClient(id).then((data) => {\n            if (data.error) {\n                updateSnackBarMessage(data.error.message);\n            } else if (data.success) {\n                updateSnackBarMessage('Client has been deleted successfully!');\n                setRows(rows.filter(row => row.id !== cellValue?.id));\n                setOpenDialog(false);\n            } else {\n                updateSnackBarMessage('An unexpected error occurred. Please try again !');\n            }\n        });\n    }\n\n    const handleCloseDialog = () => {\n        setOpenDialog(false);\n    };\n\n    const handleUpdatedClientSuccess = (rowValue: Client, client: Client) => {\n        setRows(rows.map(row => row._id === rowValue._id ? {...row, ...client} : row));\n        setOpenUpdateClient(false);\n    }\n\n    const dialog = language === 'tr' ? { \n                                            text: 'Bu müşteriyi silmek istediğinizden emin misiniz?',\n                                            yes: 'Evet',\n                                            no: 'Hayır ' \n                                        } : \n                                        {\n                                            text: 'Are you sure you want to delete this client?',\n                                            yes: 'Yes',\n                                            no: 'No '\n                                        }\n\n    const columns = language === 'tr' ? turkishClientColumn(handleEditClick, handleCancelClick) \n                                        : engClientColumn(handleEditClick, handleCancelClick);\n\n    return (\n        <>\n            <DataTable rows={rows} columns={columns} />\n            <CustomDialog open={openDialog} onClose={handleCloseDialog}>\n                <>\n                    <Box display='flex' alignItems='center' flexDirection=\"column\" className={mainBox}>\n                            <Typography className={title}>\n                                {dialog.text}\n                            </Typography>\n                            <Box justifyContent='center' m={2} pt={3}>\n                                <CustomButton btnText={dialog.yes} style='yes' onClick={onYesClick} />\n                                <CustomButton btnText={dialog.no} style='no' onClick={handleCloseDialog} />\n                            </Box>\n                    </Box>\n                </>\n            </CustomDialog>\n            <CustomDialog open={openUpdateClient} onClose={handleUpdateClientClose}>\n                <UpdateClient values={cellValue} handleUpdatedClientSuccess={handleUpdatedClientSuccess} />\n            </CustomDialog>\n        </>\n    )\n};\n\nexport default ListClients;"]},"metadata":{},"sourceType":"module"}